<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Stoisko z LemonadÄ…</title>
<style>
  body { font-family: monospace; padding: 20px; background: #f0f0f0; }
  #loginDiv, #mainDiv { margin-bottom: 20px; }
  #mainDiv { display: none; }
  button { margin: 5px; padding: 5px 10px; }
  #receipt {
    white-space: pre;
    border: 1px solid #000;
    padding: 10px;
    margin-top: 10px;
    background: #fff;
  }
</style>
</head>
<body>

<div id="loginDiv">
  <h2>Logowanie do stoiska</h2>
  Login: <input type="text" id="login"><br>
  HasÅ‚o: <input type="password" id="password"><br>
  <button onclick="login()">Zaloguj</button>
  <p id="loginMsg"></p>
</div>

<div id="mainDiv">
  <h2>Stoisko z LemonadÄ…</h2>

  <div>
    Lemoniada bez soku: <span id="count1">0</span>
    <button onclick="changeCount(1,1)">+</button>
    <button onclick="changeCount(1,-1)">-</button>
  </div>

  <div>
    Lemoniada z sokiem: <span id="count2">0</span>
    <button onclick="changeCount(2,1)">+</button>
    <button onclick="changeCount(2,-1)">-</button>
  </div>

  <h3>Do zapÅ‚aty: <span id="total">0.00</span> zÅ‚</h3>

  <button onclick="printReceipt()">WyÅ›wietl paragon</button>
  <button onclick="downloadReceiptAsImage()">Pobierz paragon jako obraz</button>
  <button onclick="copyReceiptToClipboard()">Skopiuj paragon jako obraz</button>
  <button onclick="resetEarnings()">Wyzeruj zarobki (admin)</button>

  <h3>Dzisiaj: <span id="dailyTotal">0.00</span> zÅ‚</h3>
  <h3>Wszystkie dni: <span id="allTimeTotal">0.00</span> zÅ‚</h3>

  <div id="receipt"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
/* ===== USTAWIENIA ===== */
const ADMIN_PASSWORD = "admin123"; // <<< ZMIEÅƒ HASÅO TUTAJ

let price1 = 2.5;
let price2 = 3.0;
let count1 = 0;
let count2 = 0;

let dailyTotal = parseFloat(localStorage.getItem("dailyTotal")) || 0;
let allTimeTotal = parseFloat(localStorage.getItem("allTimeTotal")) || 0;

document.getElementById("dailyTotal").innerText = dailyTotal.toFixed(2);
document.getElementById("allTimeTotal").innerText = allTimeTotal.toFixed(2);

/* ===== LOGOWANIE ===== */
function login(){
  if(
    document.getElementById("login").value === "stoisko" &&
    document.getElementById("password").value === "lemoniada123"
  ){
    loginDiv.style.display = "none";
    mainDiv.style.display = "block";
  } else {
    loginMsg.innerText = "BÅ‚Ä™dny login lub hasÅ‚o!";
  }
}

/* ===== LICZNIKI ===== */
function changeCount(type, delta){
  if(type === 1){
    count1 = Math.max(0, count1 + delta);
    count1Span.innerText = count1;
  } else {
    count2 = Math.max(0, count2 + delta);
    count2Span.innerText = count2;
  }
  updateTotal();
}

function updateTotal(){
  total.innerText = (count1*price1 + count2*price2).toFixed(2);
}

/* ===== PARAGON ===== */
function printReceipt(){
  let totalPrice = count1*price1 + count2*price2;
  let text =
`------ PARAGON ------
${new Date().toLocaleString()}
---------------------
Bez soku x${count1} = ${(count1*price1).toFixed(2)} zÅ‚
Z sokiem x${count2} = ${(count2*price2).toFixed(2)} zÅ‚
---------------------
SUMA: ${totalPrice.toFixed(2)} zÅ‚
---------------------
DziÄ™kujemy!
`;

  receipt.innerText = text;

  dailyTotal += totalPrice;
  allTimeTotal += totalPrice;

  localStorage.setItem("dailyTotal", dailyTotal);
  localStorage.setItem("allTimeTotal", allTimeTotal);

  dailyTotalSpan.innerText = dailyTotal.toFixed(2);
  allTimeTotalSpan.innerText = allTimeTotal.toFixed(2);

  count1 = count2 = 0;
  count1Span.innerText = 0;
  count2Span.innerText = 0;
  updateTotal();
}

/* ===== RESET ZAROBKÃ“W (HASÅO ADMINA) ===== */
function resetEarnings(){
  let pass = prompt("Podaj hasÅ‚o admina:");

  if(pass !== ADMIN_PASSWORD){
    alert("âŒ ZÅ‚e hasÅ‚o!");
    return;
  }

  dailyTotal = 0;
  allTimeTotal = 0;

  localStorage.setItem("dailyTotal", 0);
  localStorage.setItem("allTimeTotal", 0);

  dailyTotalSpan.innerText = "0.00";
  allTimeTotalSpan.innerText = "0.00";

  alert("âœ… Zarobki wyzerowane");
}

/* ===== OBRAZ PARAGONU ===== */
function downloadReceiptAsImage(){
  if(!receipt.innerText.trim()){
    alert("Brak paragonu!");
    return;
  }
  html2canvas(receipt).then(c=>{
    let a = document.createElement("a");
    a.href = c.toDataURL();
    a.download = "paragon.png";
    a.click();
  });
}

async function copyReceiptToClipboard(){
  if(!receipt.innerText.trim()){
    alert("Brak paragonu!");
    return;
  }
  const canvas = await html2canvas(receipt);
  canvas.toBlob(b=>{
    navigator.clipboard.write([new ClipboardItem({"image/png": b})]);
    alert("ðŸ“‹ Skopiowano do schowka");
  });
}

/* ===== SKRÃ“TY ===== */
const count1Span = document.getElementById("count1");
const count2Span = document.getElementById("count2");
const total = document.getElementById("total");
const receipt = document.getElementById("receipt");
const dailyTotalSpan = document.getElementById("dailyTotal");
const allTimeTotalSpan = document.getElementById("allTimeTotal");
</script>

</body>
</html>
