<script>
// --- Logowanie użytkownika ---
const users = { "stoisko":"lemoniada123", "admin":"admin123" };

// --- Odczyt zarobku z localStorage przy starcie ---
let zarobekDzis = parseFloat(localStorage.getItem('zarobekDzis')) || 0;
let zarobekCalk = parseFloat(localStorage.getItem('zarobekCalk')) || 0;

function zaloguj(){
    const login = document.getElementById('login').value;
    const pass = document.getElementById('password').value;
    if(users[login] && users[login]===pass){
        document.getElementById('loginPanel').style.display='none';
        document.getElementById('header').style.display='block';
        document.getElementById('products').style.display='block';
        document.getElementById('buttons').style.display='flex';
        document.getElementById('paragon').style.display='block';
        document.getElementById('wartoscZakupu').style.display='block';
        document.getElementById('zarobek').style.display='block';
        document.getElementById('zarobekCalkowity').style.display='block';
        ustawDate();
        aktualizujParagon();
        aktualizujWartoscZakupu();
        aktualizujZarobek();
    } else {
        document.getElementById('loginError').innerText="Błędny login lub hasło!";
    }
}

// --- Produkty ---
let produkty = {
    "bezSoku": {nazwa:"Lem. bez soku", cena:2.5, ilosc:0},
    "zSokiem": {nazwa:"Lem. z sokiem", cena:3, ilosc:0}
};

function zmienIlosc(prod, delta){
    produkty[prod].ilosc += delta;
    if(produkty[prod].ilosc<0) produkty[prod].ilosc=0;
    document.getElementById(prod).innerText = produkty[prod].ilosc;
    aktualizujWartoscZakupu();
    aktualizujParagon();
}

// --- Wartość zakupu / paragon ---
let sumaZakupu = 0;

function aktualizujWartoscZakupu(){
    let suma=0;
    for(let p in produkty) suma += produkty[p].ilosc*produkty[p].cena;
    sumaZakupu = suma;
    document.getElementById('wartoscZakupu').innerText=`Wartość zakupu: ${suma.toFixed(2)} zł`;
    document.getElementById('parSum').innerText=`SUMA: ${suma.toFixed(2)} zł`;
}

function ustawDate(){
    const dzis=new Date();
    const dz=String(dzis.getDate()).padStart(2,'0');
    const mies=String(dzis.getMonth()+1).padStart(2,'0');
    const rok=dzis.getFullYear();
    const godz=String(dzis.getHours()).padStart(2,'0');
    const min=String(dzis.getMinutes()).padStart(2,'0');
    const sek=String(dzis.getSeconds()).padStart(2,'0');
    document.getElementById('parDate').innerText=`Data: ${dz}.${mies}.${rok}, ${godz}:${min}:${sek}`;
}
setInterval(ustawDate,1000);

function aktualizujParagon(){
    const par=document.getElementById('parItems');
    par.innerHTML='';
    for(let p in produkty){
        if(produkty[p].ilosc>0){
            const div = document.createElement('div');
            div.className='parItem';
            div.innerHTML=`<span>${produkty[p].nazwa}</span><span>x${produkty[p].ilosc} ${(produkty[p].ilosc*produkty[p].cena).toFixed(2)} zł</span>`;
            par.appendChild(div);
        }
    }
}

// --- Generuj paragon ---
function generujParagon(){
    aktualizujParagon();
    zarobekDzis += sumaZakupu;
    zarobekCalk += sumaZakupu;
    aktualizujZarobek();

    // --- Zapis w localStorage ---
    localStorage.setItem('zarobekDzis', zarobekDzis);
    localStorage.setItem('zarobekCalk', zarobekCalk);

    // --- Wyzerowanie liczników produktów po generowaniu ---
    for(let p in produkty){
        produkty[p].ilosc = 0;
        document.getElementById(p).innerText = 0;
    }
    aktualizujParagon();
    aktualizujWartoscZakupu();
    alert('Paragon wygenerowany i zarobek zapisany!');
}

// --- Aktualizacja zarobku ---
function aktualizujZarobek(){
    document.getElementById('zarobek').innerText = `Zarobek z dzisiaj: ${zarobekDzis.toFixed(2)} zł`;
    document.getElementById('zarobekCalkowity').innerText = `Zarobek łącznie: ${zarobekCalk.toFixed(2)} zł`;
    // --- Zapis w localStorage przy każdej zmianie admina ---
    localStorage.setItem('zarobekDzis', zarobekDzis);
    localStorage.setItem('zarobekCalk', zarobekCalk);
}

// --- Pozostałe funkcje admina / kopiuj / pobierz pozostają bez zmian ---
</script>
