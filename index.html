<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Stoisko z lemoniadą</title>
<style>
body {
    font-family: monospace;
    background: #f0f0f0;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
}
#loginPanel { text-align:center; margin-bottom:20px; }
#loginPanel h2 { font-size:28px; font-weight:bold; margin-bottom:10px; }
#loginPanel input { margin:5px; }

#header { display:none; font-size:24px; font-weight:bold; margin-bottom:20px; text-align:center; }
.product { display:flex; justify-content:space-between; width:300px; margin:5px 0; align-items:center; }
.product span.ilosc { width:30px; text-align:center; }
.product button { width:30px; margin-left:5px; }

#buttons { display:none; flex-wrap:wrap; gap:10px; margin:10px 0; }
#zarobek, #zarobekCalkowity { font-weight:bold; margin:5px 0; }
#wartoscZakupu { font-weight:bold; margin-bottom:10px; }

#paragon {
    background:white;
    padding:10px 15px;
    border:1px dashed black;
    text-align:center;
    min-width:250px;
}
.parLine { white-space: pre; display:block; }
.parTitle { font-weight:bold; font-size:18px; margin:6px 0; }
.parItem { display:flex; justify-content:space-between; margin:2px 0; }
.parSum { font-weight:bold; margin:6px 0; }
.parThanks { margin-top:4px; }

#adminPanel, #loginAdminPanel {
    display:none;
    position:fixed;
    background:#fff;
    border:2px solid black;
    padding:15px;
    z-index:100;
    top:30%;
    left:50%;
    transform:translate(-50%, -30%);
    min-width:300px;
}
#adminPanel input[type=number] { width:60px; text-align:center; }
#adminPanel button, #loginAdminPanel button { margin:5px; }
#loginAdminPanel input { margin:5px; }
</style>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>

<div id="loginPanel">
    <h2>Logowanie</h2>
    <input type="text" id="login" placeholder="Login">
    <input type="password" id="password" placeholder="Hasło">
    <button onclick="zaloguj()">Zaloguj</button>
    <div id="loginError" style="color:red; margin-top:5px;"></div>
</div>

<div id="header">Stoisko z lemoniadą</div>

<div id="products" style="display:none;">
    <div class="product">
        <span>Lem. bez soku</span>
        <span id="bezSoku" class="ilosc">0</span>
        <button onclick="zmienIlosc('bezSoku',1)">+</button>
        <button onclick="zmienIlosc('bezSoku',-1)">-</button>
    </div>
    <div class="product">
        <span>Lem. z sokiem</span>
        <span id="zSokiem" class="ilosc">0</span>
        <button onclick="zmienIlosc('zSokiem',1)">+</button>
        <button onclick="zmienIlosc('zSokiem',-1)">-</button>
    </div>
</div>

<div id="buttons">
    <button onclick="kopiujParagon()">Kopiuj paragon jako obraz</button>
    <button onclick="pobierzParagon()">Pobierz paragon jako obraz</button>
    <button onclick="generujParagon()">Generuj paragon</button>
    <button onclick="wezLoginAdmin('odejmij')">Odejmij zarobek (admin)</button>
    <button onclick="wezLoginAdmin('dodaj')">Dodaj zarobek (admin)</button>
    <button onclick="wezLoginAdmin('wyzeruj')">Wyzeruj zarobek (admin)</button>
</div>

<div id="zarobek" style="display:none;">Zarobek z dzisiaj: 0.00 zł</div>
<div id="zarobekCalkowity" style="display:none;">Zarobek łącznie: 0.00 zł</div>
<div id="wartoscZakupu" style="display:none;">Wartość zakupu: 0 zł</div>

<div id="paragon" style="display:none;">
    <div class="parLine">==============================</div>
    <div class="parTitle">LEMONIADA</div>
    <div class="parLine">==============================</div>
    <div id="parDate" class="parLine">Data: --</div>
    <div class="parLine">------------------------------</div>
    <div id="parItems"></div>
    <div class="parLine">------------------------------</div>
    <div id="parSum" class="parSum">SUMA: 0.00 zł</div>
    <div class="parLine">==============================</div>
    <div class="parThanks">Dziękujemy za zakupy!</div>
    <div class="parLine">==============================</div>
</div>

<div id="loginAdminPanel">
    <div>Wpisz login i hasło admina</div>
    <input type="text" id="adminLogin" placeholder="Login"><br>
    <input type="password" id="adminPass" placeholder="Hasło"><br>
    <button onclick="zalogujAdmin()">Zatwierdź</button>
    <button onclick="anulujAdminLogin()">Anuluj</button>
    <div id="loginAdminError" style="color:red; margin-top:5px;"></div>
</div>

<div id="adminPanel">
    <div id="adminActionTitle"></div>
    Kwota: <input type="number" id="adminKwota" value="0"><br>
    <button onclick="zmienKwote(1)">+</button>
    <button onclick="zmienKwote(-1)">-</button><br>
    <button onclick="zatwierdzAdminAction()">Zatwierdź</button>
    <button onclick="anulujAdminAction()">Anuluj</button>
</div>

<script>
// --- Logowanie lokalne ---
const users = { "stoisko":"lemoniada123", "admin":"admin123" };
function zaloguj(){
    const login=document.getElementById('login').value;
    const pass=document.getElementById('password').value;
    if(users[login] && users[login]===pass){
        document.getElementById('loginPanel').style.display='none';
        document.getElementById('header').style.display='block';
        document.getElementById('products').style.display='block';
        document.getElementById('buttons').style.display='flex';
        document.getElementById('paragon').style.display='block';
        document.getElementById('wartoscZakupu').style.display='block';
        document.getElementById('zarobek').style.display='block';
        document.getElementById('zarobekCalkowity').style.display='block';
        ustawDate();
        aktualizujWartoscZakupu();
        aktualizujZarobek();
    } else {
        document.getElementById('loginError').innerText="Błędny login lub hasło!";
    }
}

// --- Produkty ---
let produkty = {
    "bezSoku": {nazwa:"Lem. bez soku", cena:2.5, ilosc:0},
    "zSokiem": {nazwa:"Lem. z sokiem", cena:3, ilosc:0}
};
let sumaZakupu = 0;
let zarobekDzis = 0;
let zarobekCalk = 0;

function zmienIlosc(prod, delta){
    produkty[prod].ilosc += delta;
    if(produkty[prod].ilosc<0) produkty[prod].ilosc=0;
    document.getElementById(prod).innerText = produkty[prod].ilosc;
    aktualizujWartoscZakupu();
}

// --- Wartość zakupu ---
function aktualizujWartoscZakupu(){
    let suma=0;
    for(let p in produkty) suma += produkty[p].ilosc*produkty[p].cena;
    sumaZakupu = suma;
    document.getElementById('wartoscZakupu').innerText=`Wartość zakupu: ${suma.toFixed(2)} zł`;
}

// --- Paragon ---
function ustawDate(){
    const dzis=new Date();
    const dz=String(dzis.getDate()).padStart(2,'0');
    const mies=String(dzis.getMonth()+1).padStart(2,'0');
    const rok=dzis.getFullYear();
    const godz=String(dzis.getHours()).padStart(2,'0');
    const min=String(dzis.getMinutes()).padStart(2,'0');
    const sek=String(dzis.getSeconds()).padStart(2,'0');
    document.getElementById('parDate').innerText=`Data: ${dz}.${mies}.${rok}, ${godz}:${min}:${sek}`;
}
function aktualizujParagon(){
    const par=document.getElementById('parItems');
    par.innerHTML='';
    for(let p in produkty){
        if(produkty[p].ilosc>0){
            const div = document.createElement('div');
            div.className='parItem';
            div.innerHTML=`<span>${produkty[p].nazwa} x${produkty[p].ilosc}</span><span>${(produkty[p].ilosc*produkty[p].cena).toFixed(2)} zł</span>`;
            par.appendChild(div);
        }
    }
}
function generujParagon(){
    aktualizujParagon();
    zarobekDzis += sumaZakupu;
    zarobekCalk += sumaZakupu;
    aktualizujZarobek();
    // wyzeruj liczniki produktów
    for(let p in produkty){ produkty[p].ilosc=0; document.getElementById(p).innerText=0; }
    aktualizujWartoscZakupu();
    alert('Paragon wygenerowany i zarobek zapisany!');
}

// --- Zarobek ---
function aktualizujZarobek(){
    document.getElementById('zarobek').innerText = `Zarobek z dzisiaj: ${zarobekDzis.toFixed(2)} zł`;
    document.getElementById('zarobekCalkowity').innerText = `Zarobek łącznie: ${zarobekCalk.toFixed(2)} zł`;
}

// --- Admin ---
let currentAdminAction='';
function wezLoginAdmin(action){
    currentAdminAction=action;
    document.getElementById('loginAdminPanel').style.display='block';
    document.getElementById('loginAdminError').innerText='';
    document.getElementById('adminLogin').value='';
    document.getElementById('adminPass').value='';
}
function anulujAdminLogin(){ document.getElementById('loginAdminPanel').style.display='none'; }
function zalogujAdmin(){
    const login=document.getElementById('adminLogin').value;
    const pass=document.getElementById('adminPass').value;
    if(login==='admin' && pass==='admin123'){
        document.getElementById('loginAdminPanel').style.display='none';
        if(currentAdminAction==='wyzeruj'){ zarobekDzis=0; zarobekCalk=0; aktualizujZarobek(); alert('Zarobek wyzerowany!'); }
        else { pokazAdminPanel(); }
    } else { document.getElementById('loginAdminError').innerText='Błędny login lub hasło!'; }
}
function pokazAdminPanel(){
    const panel=document.getElementById('adminPanel');
    panel.style.display='block';
    const title=document.getElementById('adminActionTitle');
    const kwotaInput=document.getElementById('adminKwota');
    kwotaInput.value=0;
    title.innerText = currentAdminAction==='dodaj' ? 'Dodaj zarobek' : 'Odejmij zarobek';
}
function zmienKwote(delta){
    const kw=document.getElementById('adminKwota');
    kw.value = Math.max(0, parseFloat(kw.value)+delta);
}
function zatwierdzAdminAction(){
    const kw=parseFloat(document.getElementById('adminKwota').value);
    if(currentAdminAction==='dodaj'){ zarobekDzis += kw; zarobekCalk += kw; }
    else if(currentAdminAction==='odejmij'){ zarobekDzis -= kw; zarobekCalk -= kw; if(zarobekDzis<0) zarobekDzis=0; if(zarobekCalk<0) zarobekCalk=0; }
    aktualizujZarobek();
    document.getElementById('adminPanel').style.display='none';
}
function anulujAdminAction(){ document.getElementById('adminPanel').style.display='none'; }

// --- Kopiuj / pobierz paragon ---
function kopiujParagon(){
    const paragon=document.getElementById('paragon');
    const range=document.createRange();
    range.selectNode(paragon);
    window.getSelection().removeAllRanges();
    window.getSelection().addRange(range);
    document.execCommand('copy');
    window.getSelection().removeAllRanges();
    alert('Paragon skopiowany!');
}
function pobierzParagon(){
    const paragon=document.getElementById('paragon');
    html2canvas(paragon).then(canvas => {
        const link = document.createElement('a');
        link.download = 'paragon.png';
        link.href = canvas.toDataURL();
        link.click();
    });
}

setInterval(ustawDate,1000);
</script>
</body>
    </html>
